<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# pgtest

```go
import "github.com/induzo/gocom/database/pgtest"
```

Package pgtest implements dockertest with postgres for testing.

### Use case in TestMain

```
var dockertest *pgtest.DockertestWrapper

func TestMain(m *testing.M) {
	dockertest = pgtest.New()

	code := m.Run()

	dockertest.Purge()

	os.Exit(code)
}

func TestFunc(t *testing.T) {
	t.Parallel()

	repo := NewRepo(dockertest.ConnPool)

	tests := []struct{
		name string
	}{}
	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			...
		})
	}
}

func TestRun(t *testing.T) {
	t.Parallel()

	tests := []struct{
		name string
	}{}
	for _, tt := range tests {
		tt := tt
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			repo := NewRepo(dockertest.ConnPool)
			...
		})
	}
}
```

## Index

- [type ConnPoolNotFoundError](<#type-connpoolnotfounderror>)
  - [func (e *ConnPoolNotFoundError) Error() string](<#func-connpoolnotfounderror-error>)
- [type DockertestWrapper](<#type-dockertestwrapper>)
  - [func New() *DockertestWrapper](<#func-new>)
  - [func (dw *DockertestWrapper) PrepareTestCaseDB(migrationFiles embed.FS, migrationPath string) (*pgxpool.Pool, error)](<#func-dockertestwrapper-preparetestcasedb>)
  - [func (dw *DockertestWrapper) Purge()](<#func-dockertestwrapper-purge>)


## type ConnPoolNotFoundError

```go
type ConnPoolNotFoundError struct{}
```

### func \(\*ConnPoolNotFoundError\) Error

```go
func (e *ConnPoolNotFoundError) Error() string
```

## type DockertestWrapper

```go
type DockertestWrapper struct {
    DockertestPool     *dockertest.Pool
    DockertestResource *dockertest.Resource
    ConnPool           *pgxpool.Pool
}
```

### func New

```go
func New() *DockertestWrapper
```

<details><summary>Example</summary>
<p>

```go
package main

import (
	"github.com/induzo/gocom/database/pgtest"
)

func main() { //nolint: testableexamples // dockertest no output
	dockertest := pgtest.New()

	// repo := NewRepo(dockertest.ConnPool)
	// do something...

	dockertest.Purge()
}
```

</p>
</details>

### func \(\*DockertestWrapper\) PrepareTestCaseDB

```go
func (dw *DockertestWrapper) PrepareTestCaseDB(migrationFiles embed.FS, migrationPath string) (*pgxpool.Pool, error)
```

### func \(\*DockertestWrapper\) Purge

```go
func (dw *DockertestWrapper) Purge()
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
