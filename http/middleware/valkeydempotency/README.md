<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# valkeydempotency

```go
import "github.com/induzo/gocom/http/middleware/valkeydempotency"
```

valkeydempotency is a package which implement the store interface for the idempotency package with valkey.

## Index

- [func NewMiddleware\(lockerOption \*valkeylock.LockerOption, ttl time.Duration, options ...idempotency.Option\) \(func\(http.Handler\) http.Handler, func\(\) error, error\)](<#NewMiddleware>)
- [type Store](<#Store>)
  - [func NewStore\(lockerOption \*valkeylock.LockerOption, ttl time.Duration\) \(\*Store, error\)](<#NewStore>)
  - [func \(sto \*Store\) Close\(\) error](<#Store.Close>)
  - [func \(sto \*Store\) GetStoredResponse\(ctx context.Context, key string\) \(\*idempotency.StoredResponse, bool, error\)](<#Store.GetStoredResponse>)
  - [func \(sto \*Store\) StoreResponse\(ctx context.Context, key string, resp \*idempotency.StoredResponse\) error](<#Store.StoreResponse>)
  - [func \(sto \*Store\) TryLock\(ctx context.Context, key string\) \(context.Context, context.CancelFunc, error\)](<#Store.TryLock>)
- [type TTLIncorrectError](<#TTLIncorrectError>)
  - [func \(e \*TTLIncorrectError\) Error\(\) string](<#TTLIncorrectError.Error>)


<a name="NewMiddleware"></a>
## func [NewMiddleware](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/middleware.go#L14-L18>)

```go
func NewMiddleware(lockerOption *valkeylock.LockerOption, ttl time.Duration, options ...idempotency.Option) (func(http.Handler) http.Handler, func() error, error)
```

Middleware enforces idempotency on non\-GET requests.

<a name="Store"></a>
## type [Store](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L24-L28>)



```go
type Store struct {
    // contains filtered or unexported fields
}
```

<a name="NewStore"></a>
### func [NewStore](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L44>)

```go
func NewStore(lockerOption *valkeylock.LockerOption, ttl time.Duration) (*Store, error)
```



<a name="Store.Close"></a>
### func \(\*Store\) [Close](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L30>)

```go
func (sto *Store) Close() error
```



<a name="Store.GetStoredResponse"></a>
### func \(\*Store\) [GetStoredResponse](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L102-L105>)

```go
func (sto *Store) GetStoredResponse(ctx context.Context, key string) (*idempotency.StoredResponse, bool, error)
```



<a name="Store.StoreResponse"></a>
### func \(\*Store\) [StoreResponse](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L76-L80>)

```go
func (sto *Store) StoreResponse(ctx context.Context, key string, resp *idempotency.StoredResponse) error
```



<a name="Store.TryLock"></a>
### func \(\*Store\) [TryLock](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L64-L67>)

```go
func (sto *Store) TryLock(ctx context.Context, key string) (context.Context, context.CancelFunc, error)
```



<a name="TTLIncorrectError"></a>
## type [TTLIncorrectError](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L36-L38>)



```go
type TTLIncorrectError struct {
    // contains filtered or unexported fields
}
```

<a name="TTLIncorrectError.Error"></a>
### func \(\*TTLIncorrectError\) [Error](<https://github.com/induzo/gocom/blob/main/http/middleware/valkeydempotency/store.go#L40>)

```go
func (e *TTLIncorrectError) Error() string
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
