<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# otelinit

```go
import "github.com/induzo/gocom/monitoring/otelinit"
```

This package allows you to init and enable tracing in your app

## Index

- [func InitTraceProvider(ctx context.Context, serviceName string, options ...trace.ProviderOptionFunc) (func() error, error)](<#func-inittraceprovider>)
- [func Start(ctx context.Context, conf *Config) ([]func(ctx context.Context) error, error)](<#func-start>)
- [func StartTrace(ctx context.Context, conf *Config) (func(ctx context.Context) error, error)](<#func-starttrace>)
- [type Config](<#type-config>)


## func InitTraceProvider

```go
func InitTraceProvider(ctx context.Context, serviceName string, options ...trace.ProviderOptionFunc) (func() error, error)
```

<details><summary>Example (Collector)</summary>
<p>

Initialize a otel trace provider with a collector

```go
package main

import (
	"context"
	"fmt"
	"log"

	"go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"

	"github.com/induzo/gocom/monitoring/otelinit"
	"github.com/induzo/gocom/monitoring/otelinit/trace"
)

func main() {
	ctx := context.Background()

	shutdown, err := otelinit.InitTraceProvider(
		ctx,
		"simple-gohttp",
		trace.WithGRPCTraceExporter(
			ctx,
			otlptracegrpc.WithEndpoint(fmt.Sprintf("%s:%d", "otlp.nr-data.net", 4317)),
			otlptracegrpc.WithHeaders(map[string]string{"api-key": "123"}),
			otlptracegrpc.WithCompressor("gzip"),
		),
	)
	if err != nil {
		log.Println("failed to initialize opentelemetry")

		return
	}

	defer func() {
		if errS := shutdown(); errS != nil {
			log.Println("failed to shutdown")
		}
	}()

	fmt.Println(err)

}
```

#### Output

```
<nil>
```

</p>
</details>

<details><summary>Example (Discard Traces)</summary>
<p>

Initialize a otel trace provider and discard traces useful for dev

```go
package main

import (
	"context"
	"fmt"
	"io"
	"log"

	"github.com/induzo/gocom/monitoring/otelinit"
	"github.com/induzo/gocom/monitoring/otelinit/trace"
)

func main() {
	ctx := context.Background()

	shutdown, err := otelinit.InitTraceProvider(
		ctx,
		"simple-gohttp",
		trace.WithWriterTraceExporter(io.Discard),
	)
	if err != nil {
		log.Println("failed to initialize opentelemetry")

		return
	}

	defer func() {
		if errS := shutdown(); errS != nil {
			log.Println("failed to shutdown")
		}
	}()

	fmt.Println(err)

}
```

#### Output

```
<nil>
```

</p>
</details>

## func Start

```go
func Start(ctx context.Context, conf *Config) ([]func(ctx context.Context) error, error)
```

<details><summary>Example (Collector)</summary>
<p>

Init and start an otel trace and metric provider with a collector

```go
package main

import (
	"context"
	"fmt"
	"log"

	"github.com/induzo/gocom/monitoring/otelinit"
)

func main() {
	ctx := context.Background()

	shutdowns, err := otelinit.Start(ctx, &otelinit.Config{
		AppName:       "simple-gohttp",
		Host:          "otlp.nr-data.net",
		Port:          4317,
		APIKey:        "123",
		IsSecure:      true,
		EnableMetrics: true,
	})
	if err != nil {
		log.Println("failed to start opentelemetry")

		return
	}

	for _, s := range shutdowns {
		shutdown := s
		defer func() {
			if errS := shutdown(ctx); errS != nil {
				log.Println("failed to shutdown")
			}
		}()
	}

	fmt.Println(err)

}
```

#### Output

```
<nil>
```

</p>
</details>

<details><summary>Example (Collector_trace_only)</summary>
<p>

Init and start an otel trace provider with a collector only

```go
package main

import (
	"context"
	"fmt"
	"log"

	"github.com/induzo/gocom/monitoring/otelinit"
)

func main() {
	ctx := context.Background()

	shutdowns, err := otelinit.Start(ctx, &otelinit.Config{
		AppName:       "simple-gohttp",
		Host:          "otlp.nr-data.net",
		Port:          4317,
		APIKey:        "123",
		IsSecure:      true,
		EnableMetrics: false,
	})
	if err != nil {
		log.Println("failed to start opentelemetry")

		return
	}

	for _, s := range shutdowns {
		shutdown := s
		defer func() {
			if errS := shutdown(ctx); errS != nil {
				log.Println("failed to shutdown")
			}
		}()
	}

	fmt.Println(err)

}
```

#### Output

```
<nil>
```

</p>
</details>

## func StartTrace

```go
func StartTrace(ctx context.Context, conf *Config) (func(ctx context.Context) error, error)
```

<details><summary>Example (Collector)</summary>
<p>

Init and start an otel trace provider with a collector

```go
package main

import (
	"context"
	"fmt"
	"log"

	"github.com/induzo/gocom/monitoring/otelinit"
)

func main() {
	ctx := context.Background()

	shutdown, err := otelinit.StartTrace(ctx, &otelinit.Config{
		AppName:  "simple-gohttp",
		Host:     "otlp.nr-data.net",
		Port:     4317,
		APIKey:   "123",
		IsSecure: true,
	})
	if err != nil {
		log.Println("failed to start opentelemetry")

		return
	}

	defer func() {
		if errS := shutdown(ctx); errS != nil {
			log.Println("failed to shutdown trace")
		}
	}()

	fmt.Println(err)

}
```

#### Output

```
<nil>
```

</p>
</details>

## type Config

Config allow you to set opentelemetry trace and metric, the variable of EnableMetric only used when Start\(\)

```go
type Config struct {
    AppName       string
    Host          string
    Port          int
    APIKey        string
    IsSecure      bool
    EnableMetrics bool
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
